---
title: js重点知识-9-内存管理机制
date: 2020-12-22 16:20:02
top: true
tags:
- 内存管理机制
categories:
- JavaScript
---
### 一、内存分配
<!--more-->
当我们声明变量、函数、对象的时候，系统会自动为他们分配内存

```js
// 为变量分配内存
var i = 11;
var s = "ifcode";

// 为对象分配内存
var person = {
    age: 22,
    name: 'ifcode'
};

// 为函数分配内存
function sum(a, b) {
    return a + b;
}
```

### 二、内存使用

即读写内存，也就是使用变量、函数等

### 三、内存泄漏

内存泄露是指你用不到（访问不到）的变量，依然占居着内存空间，不能被再次利用起来。  

使用闭包函数时，回收不了闭包里面引用的变量，就会造成内存泄漏；

可以使用outColor = null; //释放内存

### 四、内存回收

使用完毕，由垃圾回收自动回收不再使用的内存。

javascript是一门具有自动垃圾收集机制的编程语言，开发人员不必关心内存分配和回收问题。这种垃圾收集机制的原理就是：找出那些不再继续使用的变量，然后释放其占用的内存。

解除变量的引用不仅有助于消除循环引用现象，而且对垃圾收集也有好处。为了确保有效的回收内存，应及时解除不再使用的全局对象、全集对象属性以及循环引用变量的引用。

垃圾收集器必须追踪到哪个变量有用哪个变量没用，对于不再有用的变量打上标记，用来以后收回其占用的内存，具体实现到浏览器中，通常有两个策略。

#### 4.1 标记清除

javascript中最常用的垃圾收集方式就是标记清除。

当变量进入环境时，会标记为"进入环境"，而当变量离开环境时，会标记为"离开环境"。

垃圾收集器运行时会给所有存储在内存中的变量都加上标记，然后它会去掉环境中的变量以及被环境中的变量引用的变量的标记。

而再次之后在被标记的变量就是被视为准备删除的变量，因为环境中的变量已经无法访问到这些变量了。

#### 4.2 引用计数

引用计数的含义是跟踪每个值被引用的次数。当声明了一个变量并将一个引用类型赋值给该变量时，则这个值的引用次数为1.

如果同一个只又被赋给另一个变量，则该值的引用次数加1。

当这个值的引用次数为0时，则说明没有办法再访问这个值了，就可以将空间回收。

这种垃圾收集策略不常见，因为目前javascript引擎不能再使用这种算法；但是在IE中访问原声Javascript对象时，这种算法可能会出现问题。
